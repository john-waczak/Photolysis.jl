<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cross Sections, Quantum Yields, and Photolysis Rates – no3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Cross Sections, Quantum Yields, and Photolysis Rates</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../cross_sections.html" aria-current="page">
 <span class="menu-text">Cross Sections</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../quantum_yields.html">
 <span class="menu-text">Quantum Yields</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections.html" class="sidebar-item-text sidebar-link">Cross Sections</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/O3.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{O_3}\)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/H2O2.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{H_2O_2}\)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/NO2.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{NO_2}\)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/NO3.html" class="sidebar-item-text sidebar-link active"><span class="math inline">\(\mathrm{NO_3}\)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/HONO.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{HONO}\)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/CH2O.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{CH_2O}\)</span> (Formaldehyde)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cross_sections/HONO2.html" class="sidebar-item-text sidebar-link"><span class="math inline">\(\mathrm{HONO_2}\)</span> (Nitric Acid)</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mathrmno_3" id="toc-mathrmno_3" class="nav-link active" data-scroll-target="#mathrmno_3"><span class="math inline">\(\mathrm{NO_3}\)</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="mathrmno_3" class="level1">
<h1><span class="math inline">\(\mathrm{NO_3}\)</span></h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span>, <span class="bu">MLPlotRecipes</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">HDF5</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Tables</span>, <span class="bu">DataFrames</span>, <span class="bu">CSV</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MLJ</span>, <span class="bu">MLJGaussianProcesses</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">KernelFunctions</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ParameterHandling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">include</span>(<span class="st">"./utils.jl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>predict_logσ_wΔ</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>h5_path <span class="op">=</span> <span class="st">"../../data/photolysis_data.h5"</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> <span class="st">"NO3"</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>nice_name <span class="op">=</span> <span class="st">"NO₃"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>λs, σs, T1s, T2s, source_idx, T_units, category, formula, λ_units, σ_units <span class="op">=</span> <span class="fu">get_raw_data</span>(h5_path, species)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"max λ: "</span>, <span class="fu">maximum</span>(λs))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"min λ: "</span>, <span class="fu">minimum</span>(λs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>max λ: 794.221
min λ: 200.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in spectrometer wavelengths</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>hr4000_df <span class="op">=</span> CSV.<span class="fu">File</span>(<span class="st">"../hr4000_wavelengths.txt"</span>) <span class="op">|&gt;</span> DataFrame ; </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Δλ <span class="op">=</span> <span class="fl">50</span> <span class="co"># nm for padding</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">data_to_df</span>(λs, σs, T1s, T2s, source_idx; λ_lb<span class="op">=</span><span class="fu">minimum</span>(hr4000_df.λ)<span class="op">-</span>Δλ, λ_ub<span class="op">=</span><span class="fu">maximum</span>(hr4000_df.λ)<span class="op">+</span>Δλ)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = data_to_df(λs, σs, T1s, T2s, source_idx; λ_lb=0.0, λ_ub=1200.0)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">nrow</span>(df))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22123</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div><div style="float: left;"><span>4×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">variable</th><th style="text-align: left;">mean</th><th style="text-align: left;">min</th><th style="text-align: left;">median</th><th style="text-align: left;">max</th><th style="text-align: left;">nmissing</th><th style="text-align: left;">eltype</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Symbol" style="text-align: left;">Symbol</th><th title="Float64" style="text-align: left;">Float64</th><th title="Real" style="text-align: left;">Real</th><th title="Float64" style="text-align: left;">Float64</th><th title="Real" style="text-align: left;">Real</th><th title="Int64" style="text-align: left;">Int64</th><th title="DataType" style="text-align: left;">DataType</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">λ</td><td style="text-align: right;">602.89</td><td style="text-align: right;">220.0</td><td style="text-align: right;">598.6</td><td style="text-align: right;">794.221</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">σ</td><td style="text-align: right;">2.14509e-18</td><td style="text-align: right;">5.146e-22</td><td style="text-align: right;">1.503e-18</td><td style="text-align: right;">2.28e-17</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">T</td><td style="text-align: right;">294.767</td><td style="text-align: right;">294.0</td><td style="text-align: right;">294.0</td><td style="text-align: right;">300.0</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">source_id</td><td style="text-align: right;">22.0123</td><td style="text-align: right;">2</td><td style="text-align: right;">20.0</td><td style="text-align: right;">45</td><td style="text-align: right;">0</td><td style="text-align: left;">Int64</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nskip <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">scatter</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    df.λ[<span class="fl">1</span><span class="op">:</span>nskip<span class="op">:</span><span class="kw">end</span>],</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log10</span>.(df.σ[<span class="fl">1</span><span class="op">:</span>nskip<span class="op">:</span><span class="kw">end</span>]),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    zcolor<span class="op">=</span>df.T[<span class="fl">1</span><span class="op">:</span>nskip<span class="op">:</span><span class="kw">end</span>],</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    ms<span class="op">=</span><span class="fl">3</span>, </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    msw<span class="op">=</span><span class="fl">0</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [</span><span class="sc">$</span>(λ_units)<span class="st">]"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    rightmargin<span class="op">=</span><span class="fl">10</span>Plots.mm,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">"T [</span><span class="sc">$</span>(T_units)<span class="st">]"</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Absorption Cross Section for </span><span class="sc">$</span>(nice_name)<span class="st">"</span>,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">savefig</span>(<span class="st">"O3_p2.png"</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">display</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="NO3_files/figure-html/cell-7-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">histogram</span>(df.λ, xlabel<span class="op">=</span><span class="st">"λ"</span>, ylabel<span class="op">=</span><span class="st">"counts"</span>, label<span class="op">=</span><span class="st">""</span>,)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">histogram</span>(df.T, xlabel<span class="op">=</span><span class="st">"T"</span>, label<span class="op">=</span><span class="st">""</span>,)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> <span class="fu">histogram</span>(<span class="fu">log10</span>.(df.σ), xlabel<span class="op">=</span><span class="st">"log10(σ)"</span>, label<span class="op">=</span><span class="st">""</span>,)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#p3 = histogram(df.σ, xlabel="σ", ylabel="counts")</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>phist <span class="op">=</span> <span class="fu">plot</span>(p1, p2, p3, layout<span class="op">=</span>(<span class="fl">1</span>,<span class="fl">3</span>), size<span class="op">=</span>(<span class="fl">1600</span>, <span class="fl">450</span>),  margin<span class="op">=</span><span class="fl">10</span>Plots.mm, plot_title<span class="op">=</span><span class="st">"Data Distribution for </span><span class="sc">$</span>(nice_name)<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<p><img src="NO3_files/figure-html/cell-8-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in spectrometer wavelengths</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>hr4000_df <span class="op">=</span> CSV.<span class="fu">File</span>(<span class="st">"../hr4000_wavelengths.txt"</span>) <span class="op">|&gt;</span> DataFrame ; </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deal with identical wavelength records </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>gdfs <span class="op">=</span> <span class="fu">groupby</span>(df, <span class="op">:</span>T)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>res_dfs <span class="op">=</span> []</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> gdf <span class="op">∈</span> gdfs</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    gdf_by_λ <span class="op">=</span> <span class="fu">groupby</span>(gdf, <span class="op">:</span>λ)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(res_dfs, <span class="fu">combine</span>(gdf_by_λ, [<span class="op">:</span>σ, <span class="op">:</span>T] <span class="op">.=&gt;</span> mean, renamecols <span class="op">=</span> <span class="cn">false</span>))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>df_unique <span class="op">=</span> <span class="fu">vcat</span>(res_dfs<span class="op">...</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div><div style="float: left;"><span>20259×3 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">20234 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">λ</th><th style="text-align: left;">σ</th><th style="text-align: left;">T</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: right;">654.01</td><td style="text-align: right;">1.25e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: right;">655.78</td><td style="text-align: right;">1.24e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: right;">657.8</td><td style="text-align: right;">2.0e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: right;">658.76</td><td style="text-align: right;">3.39e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: right;">659.8</td><td style="text-align: right;">6.2e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">6</td><td style="text-align: right;">660.81</td><td style="text-align: right;">1.03e-17</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">7</td><td style="text-align: right;">661.82</td><td style="text-align: right;">1.2e-17</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">8</td><td style="text-align: right;">662.78</td><td style="text-align: right;">1.17e-17</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">9</td><td style="text-align: right;">663.81</td><td style="text-align: right;">1.03e-17</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">10</td><td style="text-align: right;">664.85</td><td style="text-align: right;">8.08e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">11</td><td style="text-align: right;">665.81</td><td style="text-align: right;">7.38e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">12</td><td style="text-align: right;">666.78</td><td style="text-align: right;">5.77e-18</td><td style="text-align: right;">294.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">13</td><td style="text-align: right;">667.79</td><td style="text-align: right;">4.26e-18</td><td style="text-align: right;">294.0</td></tr><tr><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td><td style="text-align: right;">⋮</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20248</td><td style="text-align: right;">691.6</td><td style="text-align: right;">7.96825e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20249</td><td style="text-align: right;">691.8</td><td style="text-align: right;">7.84538e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20250</td><td style="text-align: right;">692.0</td><td style="text-align: right;">7.93245e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20251</td><td style="text-align: right;">692.2</td><td style="text-align: right;">7.88595e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20252</td><td style="text-align: right;">692.4</td><td style="text-align: right;">7.84575e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20253</td><td style="text-align: right;">692.6</td><td style="text-align: right;">8.07806e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20254</td><td style="text-align: right;">692.8</td><td style="text-align: right;">8.2515e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20255</td><td style="text-align: right;">693.2</td><td style="text-align: right;">8.78048e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20256</td><td style="text-align: right;">693.4</td><td style="text-align: right;">8.60858e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20257</td><td style="text-align: right;">693.6</td><td style="text-align: right;">8.8373e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20258</td><td style="text-align: right;">693.8</td><td style="text-align: right;">8.644e-20</td><td style="text-align: right;">298.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">20259</td><td style="text-align: right;">652.0</td><td style="text-align: right;">8.41e-19</td><td style="text-align: right;">300.0</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here is where we would do representative subsampling if there are too many records (&gt; 2000) </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>λ_idxs <span class="op">=</span> <span class="fu">representative_rand_sample</span>(df_unique.λ, <span class="fl">1000</span>, <span class="fl">1500</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>T_idxs <span class="op">=</span> <span class="fu">representative_rand_sample</span>(df_unique.λ, <span class="fl">5</span>, <span class="fl">1000</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>σ_idxs <span class="op">=</span> <span class="fu">representative_rand_sample</span>(<span class="fu">log10</span>.(df_unique.σ), <span class="fl">500</span>, <span class="fl">2000</span>) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>idxs_res <span class="op">=</span> <span class="fu">shuffle</span>(<span class="fu">unique</span>(<span class="fu">vcat</span>(λ_idxs, T_idxs, σ_idxs)))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>df_sampled <span class="op">=</span> df_unique[idxs_res, <span class="op">:</span>]</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>max_data_λ <span class="op">=</span> <span class="fu">maximum</span>(df_sampled.λ)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>min_data_λ <span class="op">=</span> <span class="fu">minimum</span>(df_sampled.λ)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">nrow</span>(df_sampled))</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(df_sampled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2017</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div><div style="float: left;"><span>3×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">variable</th><th style="text-align: left;">mean</th><th style="text-align: left;">min</th><th style="text-align: left;">median</th><th style="text-align: left;">max</th><th style="text-align: left;">nmissing</th><th style="text-align: left;">eltype</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Symbol" style="text-align: left;">Symbol</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Int64" style="text-align: left;">Int64</th><th title="DataType" style="text-align: left;">DataType</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">λ</td><td style="text-align: right;">642.954</td><td style="text-align: right;">220.0</td><td style="text-align: right;">658.388</td><td style="text-align: right;">794.221</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">σ</td><td style="text-align: right;">2.52923e-18</td><td style="text-align: right;">5.146e-22</td><td style="text-align: right;">7.99956e-19</td><td style="text-align: right;">2.2103e-17</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">T</td><td style="text-align: right;">294.569</td><td style="text-align: right;">294.0</td><td style="text-align: right;">294.0</td><td style="text-align: right;">298.0</td><td style="text-align: right;">0</td><td style="text-align: left;">Float64</td></tr></tbody></table></div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">histogram</span>(df_sampled.λ, xlabel<span class="op">=</span><span class="st">"λ"</span>, ylabel<span class="op">=</span><span class="st">"counts"</span>, label<span class="op">=</span><span class="st">""</span>, margin<span class="op">=</span><span class="fl">10</span>Plots.mm)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">histogram</span>(df_sampled.T, xlabel<span class="op">=</span><span class="st">"T"</span>, label<span class="op">=</span><span class="st">""</span>, margin<span class="op">=</span><span class="fl">10</span>Plots.mm)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> <span class="fu">histogram</span>(<span class="fu">log10</span>.(df_sampled.σ), xlabel<span class="op">=</span><span class="st">"log10(σ)"</span>, label<span class="op">=</span><span class="st">""</span>, margin<span class="op">=</span><span class="fl">10</span>Plots.mm)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#p3 = histogram(df.σ, xlabel="σ", ylabel="counts")</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>phist <span class="op">=</span> <span class="fu">plot</span>(p1, p2, p3, layout<span class="op">=</span>(<span class="fl">1</span>,<span class="fl">3</span>), size<span class="op">=</span>(<span class="fl">1600</span>, <span class="fl">450</span>), plot_title<span class="op">=</span><span class="st">"Subsampled Data Distribution for </span><span class="sc">$</span>(nice_name)<span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<p><img src="NO3_files/figure-html/cell-12-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize pre-processed data: </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">scatter</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    df_sampled.λ,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log10</span>.(df_sampled.σ),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    zcolor<span class="op">=</span>df_sampled.T,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ms<span class="op">=</span><span class="fl">3</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    msw<span class="op">=</span><span class="fl">0</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [</span><span class="sc">$</span>(λ_units)<span class="st">]"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    rightmargin<span class="op">=</span><span class="fl">10</span>Plots.mm,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">"T [</span><span class="sc">$</span>(T_units)<span class="st">]"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Absorption Cross Section for </span><span class="sc">$</span>(nice_name)<span class="st">"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<p><img src="NO3_files/figure-html/cell-13-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>train_frac <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ntrain <span class="op">=</span> <span class="fu">trunc</span>(<span class="dt">Int</span>, train_frac <span class="op">*</span> <span class="fu">nrow</span>(df_sampled))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(ntrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1916</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> <span class="fu">shuffle</span>(<span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span>(df_sampled))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>idxs_train <span class="op">=</span> idxs[<span class="fl">1</span><span class="op">:</span>ntrain]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>idxs_test <span class="op">=</span> idxs[ntrain<span class="op">+</span><span class="fl">1</span><span class="op">:</span><span class="kw">end</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Xtrain <span class="op">=</span> df_sampled[idxs_train, [<span class="op">:</span>λ, <span class="op">:</span>T]]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Xtest <span class="op">=</span> df_sampled[idxs_test, [<span class="op">:</span>λ, <span class="op">:</span>T]]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>ytrain <span class="op">=</span> <span class="fu">log10</span>.(df_sampled.σ[idxs_train])</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ytest <span class="op">=</span> <span class="fu">log10</span>.(df_sampled.σ[idxs_test])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># gpr = GPR(σ²=0.00001)</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>θ_init <span class="op">=</span> (σf² <span class="op">=</span> <span class="fu">positive</span>(<span class="fl">5.0</span>), ℓ <span class="op">=</span> <span class="fu">positive</span>(<span class="fl">0.1</span>))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>gpr <span class="op">=</span> <span class="fu">GPR</span>(</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    θ_init<span class="op">=</span>θ_init,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    σ²<span class="op">=</span><span class="fl">20.0</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># gpr = GPR(σ²=10.0)</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>mach <span class="op">=</span> <span class="fu">machine</span>(gpr, Xtrain, ytrain) <span class="op">|&gt;</span> fit!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[ Info: Training machine(GPR(μ = 0.0, …), …).</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Iter     Function value   Gradient norm 
     0     1.725343e+04     8.904625e+03
 * time: 0.00015020370483398438
     1     1.198132e+04     9.495498e+02
 * time: 9.212920188903809
     2     9.026010e+03     5.208390e+03
 * time: 13.108780145645142
     3     3.873411e+03     5.689085e+03
 * time: 19.214760065078735
     4     3.468581e+03     5.355792e+03
 * time: 25.015282154083252
     5     9.356525e+02     7.527788e+02
 * time: 26.822192192077637
     6     7.573849e+02     3.285751e+02
 * time: 28.487666130065918
     7     4.242656e+02     7.187226e+02
 * time: 32.095426082611084
     8     1.249274e+02     6.524109e+02
 * time: 33.846482038497925
     9    -4.623234e+01     2.535040e+02
 * time: 35.084794998168945
    10    -1.486345e+02     1.529568e+03
 * time: 36.811952114105225
    11    -1.955873e+02     1.678047e+03
 * time: 41.17196011543274
    12    -2.207020e+02     4.029186e+02
 * time: 42.36651301383972
    13    -2.608623e+02     7.095693e+02
 * time: 44.18816018104553
    14    -2.728099e+02     1.119270e+02
 * time: 45.85150504112244
    15    -2.743403e+02     3.507997e+01
 * time: 47.56710505485535
    16    -2.744559e+02     6.325372e+00
 * time: 49.49121904373169
    17    -2.744716e+02     6.250107e+00
 * time: 51.30982708930969
    18    -2.749709e+02     1.062268e+01
 * time: 53.73096299171448
    19    -2.749791e+02     1.553713e-02
 * time: 55.45000219345093
    20    -2.749791e+02     5.814547e-04
 * time: 57.21799302101135
    21    -2.749791e+02     2.693091e-06
 * time: 59.04600405693054
    22    -2.749791e+02     1.416536e-05
 * time: 60.917301177978516
    23    -2.749791e+02     4.429022e-06
 * time: 62.0037260055542
    24    -2.749791e+02     2.334932e-05
 * time: 66.73545408248901
    25    -2.749791e+02     8.580000e-06
 * time: 73.90340614318848
    26    -2.749791e+02     2.596045e-05
 * time: 102.82984709739685
    27    -2.749791e+02     1.946959e-05
 * time: 104.62882399559021
    28    -2.749791e+02     1.026965e-05
 * time: 105.78521704673767
    29    -2.749791e+02     1.020936e-05
 * time: 108.81097412109375
    30    -2.749791e+02     4.236842e-06
 * time: 109.89617013931274
    31    -2.749791e+02     3.089787e-06
 * time: 111.20098614692688
    32    -2.749791e+02     3.841817e-06
 * time: 112.89632821083069
    33    -2.749791e+02     1.641362e-06
 * time: 115.266282081604
    34    -2.749791e+02     8.658004e-06
 * time: 118.31331205368042
    35    -2.749791e+02     6.478390e-06
 * time: 120.01551103591919
    36    -2.749791e+02     7.266997e-06
 * time: 122.3926191329956
    37    -2.749791e+02     8.058688e-06
 * time: 124.1640272140503
    38    -2.749791e+02     1.054195e-05
 * time: 127.13166999816895
    39    -2.749791e+02     1.476962e-05
 * time: 128.32298803329468
    40    -2.749791e+02     5.690733e-06
 * time: 129.50426316261292
    41    -2.749791e+02     2.544897e-06
 * time: 130.69998121261597
    42    -2.749791e+02     6.001553e-06
 * time: 133.6245892047882
    43    -2.749791e+02     4.352708e-06
 * time: 134.91680908203125
    44    -2.749791e+02     4.926940e-06
 * time: 136.64954018592834
    45    -2.749791e+02     1.544103e-06
 * time: 144.47512221336365
    46    -2.749791e+02     1.871463e-05
 * time: 146.84941601753235
    47    -2.749791e+02     1.528552e-05
 * time: 147.96720814704895
    48    -2.749791e+02     1.188893e-05
 * time: 152.18180012702942
    49    -2.749791e+02     1.430402e-05
 * time: 153.4121379852295
    50    -2.749791e+02     7.138241e-06
 * time: 155.28769207000732
    51    -2.749791e+02     1.177137e-06
 * time: 156.5822741985321
    52    -2.749791e+02     1.529447e-05
 * time: 158.97263312339783
    53    -2.749791e+02     1.093381e-06
 * time: 160.06951713562012
    54    -2.749791e+02     3.063832e-06
 * time: 162.4764060974121
    55    -2.749791e+02     6.496821e-06
 * time: 164.86168003082275
    56    -2.749791e+02     4.213150e-06
 * time: 167.25924801826477
    57    -2.749791e+02     1.068637e-05
 * time: 169.66750621795654
    58    -2.749791e+02     8.676282e-07
 * time: 171.50134420394897
    59    -2.749791e+02     9.150952e-06
 * time: 172.6861321926117
    60    -2.749791e+02     6.790649e-06
 * time: 173.8861391544342
    61    -2.749791e+02     1.053369e-05
 * time: 175.7633180618286
    62    -2.749791e+02     8.220444e-07
 * time: 176.85399913787842
    63    -2.749791e+02     2.965746e-06
 * time: 178.80842208862305
    64    -2.749791e+02     1.740664e-05
 * time: 183.067241191864
    65    -2.749791e+02     9.233911e-06
 * time: 184.16566514968872
    66    -2.749791e+02     1.394072e-05
 * time: 185.97440719604492
    67    -2.749791e+02     1.804841e-05
 * time: 187.1720380783081
    68    -2.749791e+02     1.863934e-06
 * time: 188.957866191864
    69    -2.749791e+02     4.272391e-06
 * time: 194.36819314956665
    70    -2.749791e+02     6.092308e-06
 * time: 196.7618911266327
    71    -2.749791e+02     2.608992e-05
 * time: 225.61121010780334
    72    -2.749791e+02     1.284467e-05
 * time: 226.90408420562744
    73    -2.749791e+02     3.358607e-06
 * time: 228.0159411430359
    74    -2.749791e+02     3.111906e-06
 * time: 229.83025121688843
    75    -2.749791e+02     1.282439e-05
 * time: 231.03012013435364
    76    -2.749791e+02     4.584251e-06
 * time: 232.82284903526306
    77    -2.749791e+02     1.637574e-05
 * time: 234.12371921539307
    78    -2.749791e+02     8.343985e-06
 * time: 236.52618503570557
    79    -2.749791e+02     6.361343e-06
 * time: 237.62980699539185
    80    -2.749791e+02     7.789486e-06
 * time: 240.02955412864685
    81    -2.749791e+02     1.921895e-06
 * time: 241.87833213806152
    82    -2.749791e+02     7.385704e-06
 * time: 244.84424209594727
    83    -2.749791e+02     1.111263e-05
 * time: 248.5735981464386
    84    -2.749791e+02     2.618212e-05
 * time: 251.5117690563202
    85    -2.749791e+02     8.670445e-06
 * time: 253.5666480064392
    86    -2.749791e+02     3.051341e-06
 * time: 255.29568314552307
    87    -2.749791e+02     2.640688e-05
 * time: 256.5354700088501
    88    -2.749791e+02     5.714454e-06
 * time: 257.74622917175293
    89    -2.749791e+02     9.616752e-06
 * time: 258.98894000053406
    90    -2.749791e+02     5.695614e-06
 * time: 260.3254690170288
    91    -2.749791e+02     1.396453e-06
 * time: 262.16275811195374
    92    -2.749791e+02     7.852682e-06
 * time: 268.36989307403564
    93    -2.749791e+02     2.164833e-05
 * time: 269.49769711494446
    94    -2.749791e+02     5.129521e-06
 * time: 271.94502115249634
    95    -2.749791e+02     6.739851e-06
 * time: 275.6598811149597
    96    -2.749791e+02     9.301172e-07
 * time: 277.38840413093567
    97    -2.749791e+02     7.661521e-06
 * time: 278.596764087677
    98    -2.749791e+02     6.613859e-06
 * time: 280.5134069919586
    99    -2.749791e+02     2.407402e-06
 * time: 281.61808705329895
   100    -2.749791e+02     4.544706e-06
 * time: 287.04590821266174
   101    -2.749791e+02     2.930578e-05
 * time: 288.2553451061249
   102    -2.749791e+02     2.573552e-06
 * time: 290.13779616355896
   103    -2.749791e+02     4.893884e-06
 * time: 293.2139661312103
   104    -2.749791e+02     1.940417e-06
 * time: 294.4316442012787
   105    -2.749791e+02     9.500278e-06
 * time: 296.25281715393066
   106    -2.749791e+02     2.525142e-06
 * time: 298.1218430995941
   107    -2.749791e+02     1.443351e-05
 * time: 300.02412700653076
   108    -2.749791e+02     1.658951e-05
 * time: 306.07589316368103
   109    -2.749791e+02     1.253412e-05
 * time: 309.87325620651245
   110    -2.749791e+02     1.823920e-05
 * time: 313.39101910591125
   111    -2.749791e+02     2.177918e-05
 * time: 315.22824716567993
   112    -2.749791e+02     7.752288e-06
 * time: 317.648962020874
   113    -2.749791e+02     8.284568e-06
 * time: 319.6331651210785
   114    -2.749791e+02     1.125494e-05
 * time: 320.75067806243896
   115    -2.749791e+02     1.061338e-05
 * time: 323.1770532131195
   116    -2.749791e+02     5.046011e-06
 * time: 325.01209712028503
   117    -2.749791e+02     3.451733e-06
 * time: 329.3219380378723
   118    -2.749791e+02     1.085155e-05
 * time: 330.4254891872406
   119    -2.749791e+02     1.988474e-06
 * time: 333.772301197052
   120    -2.749791e+02     6.156550e-06
 * time: 335.5571050643921
   121    -2.749791e+02     1.542179e-06
 * time: 337.9617781639099
   122    -2.749791e+02     8.662330e-06
 * time: 340.46512508392334
   123    -2.749791e+02     1.035197e-05
 * time: 345.262011051178
   124    -2.749791e+02     5.353823e-06
 * time: 346.56252908706665
   125    -2.749791e+02     4.375706e-06
 * time: 351.3812201023102
   126    -2.749791e+02     3.748622e-06
 * time: 354.3214330673218
   127    -2.749791e+02     8.807540e-06
 * time: 355.51541018486023
   128    -2.749791e+02     6.818529e-06
 * time: 358.64032912254333
   129    -2.749791e+02     1.324451e-06
 * time: 359.7682340145111
   130    -2.749791e+02     1.820185e-05
 * time: 362.80964398384094
   131    -2.749791e+02     1.022575e-05
 * time: 364.01533913612366
   132    -2.749791e+02     5.324200e-06
 * time: 367.0149300098419
   133    -2.749791e+02     5.823497e-07
 * time: 368.3243579864502
   134    -2.749791e+02     1.114764e-06
 * time: 370.826455116272
   135    -2.749791e+02     3.295382e-06
 * time: 373.8765230178833
   136    -2.749791e+02     5.932673e-06
 * time: 375.7936780452728
   137    -2.749791e+02     2.592222e-06
 * time: 376.93559098243713
   138    -2.749791e+02     5.035876e-06
 * time: 378.2583951950073
   139    -2.749791e+02     8.553548e-06
 * time: 380.7003481388092
   140    -2.749791e+02     4.162748e-06
 * time: 381.84126901626587
   141    -2.749791e+02     1.799074e-05
 * time: 412.71160316467285
   142    -2.749791e+02     1.117538e-05
 * time: 414.65728306770325
   143    -2.749791e+02     2.308817e-06
 * time: 416.39784598350525
   144    -2.749791e+02     3.448186e-06
 * time: 418.2051010131836
   145    -2.749791e+02     1.305396e-06
 * time: 420.046275138855
   146    -2.749791e+02     1.983268e-05
 * time: 422.1255421638489
   147    -2.749791e+02     1.903887e-05
 * time: 423.9986140727997
   148    -2.749791e+02     4.902326e-06
 * time: 425.34758400917053
   149    -2.749791e+02     3.566702e-06
 * time: 429.8148031234741
   150    -2.749791e+02     5.417685e-06
 * time: 430.9578161239624
   151    -2.749791e+02     7.120840e-06
 * time: 436.74056100845337
   152    -2.749791e+02     8.758362e-06
 * time: 438.543231010437
   153    -2.749791e+02     2.703288e-05
 * time: 441.74959921836853
   154    -2.749791e+02     6.273256e-06
 * time: 444.0645170211792
   155    -2.749791e+02     6.740926e-06
 * time: 446.4979031085968
   156    -2.749791e+02     1.033476e-06
 * time: 448.6509749889374
   157    -2.749791e+02     2.647605e-06
 * time: 451.53319907188416
   158    -2.749791e+02     1.520780e-05
 * time: 454.074520111084
   159    -2.749791e+02     7.079722e-06
 * time: 456.0502061843872
   160    -2.749791e+02     6.468676e-06
 * time: 459.73265314102173
   161    -2.749791e+02     6.125588e-06
 * time: 460.961807012558
   162    -2.749791e+02     2.449978e-06
 * time: 464.767471075058
   163    -2.749791e+02     6.883534e-06
 * time: 465.9639890193939
   164    -2.749791e+02     2.259164e-06
 * time: 467.9888460636139
   165    -2.749791e+02     1.537517e-05
 * time: 469.437726020813
   166    -2.749791e+02     1.959279e-05
 * time: 470.80520820617676
   167    -2.749791e+02     1.424494e-05
 * time: 472.109836101532
   168    -2.749791e+02     9.953392e-06
 * time: 473.25613713264465
   169    -2.749791e+02     9.836373e-06
 * time: 475.0746591091156
   170    -2.749791e+02     2.100340e-06
 * time: 477.6654770374298
   171    -2.749791e+02     2.550981e-06
 * time: 478.95683312416077
   172    -2.749791e+02     1.031229e-06
 * time: 482.27072405815125
   173    -2.749791e+02     2.033632e-07
 * time: 485.34438610076904
   174    -2.749791e+02     3.076218e-06
 * time: 487.80127120018005
   175    -2.749791e+02     7.010677e-06
 * time: 489.0222690105438
   176    -2.749791e+02     2.126538e-05
 * time: 490.2679760456085
   177    -2.749791e+02     2.341258e-06
 * time: 491.6039741039276
   178    -2.749791e+02     6.542364e-06
 * time: 494.04966020584106
   179    -2.749791e+02     6.929043e-06
 * time: 495.8603370189667
   180    -2.749791e+02     1.111003e-05
 * time: 497.1950991153717
   181    -2.749791e+02     9.734576e-06
 * time: 498.9494261741638
   182    -2.749791e+02     3.424467e-06
 * time: 500.1834599971771
   183    -2.749791e+02     1.235497e-05
 * time: 504.5531630516052
   184    -2.749791e+02     9.848366e-06
 * time: 505.68613719940186
   185    -2.749791e+02     1.153698e-05
 * time: 509.46463108062744
   186    -2.749791e+02     2.918350e-06
 * time: 510.60177421569824
   187    -2.749791e+02     8.846828e-06
 * time: 514.042200088501
   188    -2.749791e+02     1.305940e-05
 * time: 516.5768351554871
   189    -2.749791e+02     3.807303e-06
 * time: 517.817458152771
   190    -2.749791e+02     7.126078e-06
 * time: 519.0262851715088
   191    -2.749791e+02     6.111975e-06
 * time: 520.8304870128632
   192    -2.749791e+02     1.067039e-05
 * time: 522.703999042511
   193    -2.749791e+02     1.980998e-05
 * time: 523.9122471809387
   194    -2.749791e+02     1.184557e-05
 * time: 525.1360499858856
   195    -2.749791e+02     1.094604e-05
 * time: 528.154862165451
   196    -2.749791e+02     9.724832e-06
 * time: 530.0064179897308
   197    -2.749791e+02     6.954451e-06
 * time: 531.9077270030975
   198    -2.749791e+02     3.441952e-06
 * time: 533.0292181968689
   199    -2.749791e+02     1.818312e-06
 * time: 534.8988561630249
   200    -2.749791e+02     5.846092e-06
 * time: 538.633551120758
   201    -2.749791e+02     1.038689e-05
 * time: 541.0750410556793
   202    -2.749791e+02     1.058886e-05
 * time: 542.3742291927338
   203    -2.749791e+02     1.294590e-06
 * time: 544.3139760494232
   204    -2.749791e+02     2.227923e-06
 * time: 546.0893499851227
   205    -2.749791e+02     8.128222e-06
 * time: 547.9989399909973
   206    -2.749791e+02     5.769838e-06
 * time: 549.8457911014557
   207    -2.749791e+02     8.314280e-06
 * time: 551.0549230575562
   208    -2.749791e+02     4.407256e-06
 * time: 552.2764902114868
   209    -2.749791e+02     2.200538e-05
 * time: 553.4830851554871
   210    -2.749791e+02     7.632329e-07
 * time: 554.7066299915314
   211    -2.749791e+02     3.293803e-06
 * time: 555.9094450473785
   212    -2.749791e+02     9.465853e-06
 * time: 561.9904541969299
   213    -2.749791e+02     9.427022e-06
 * time: 563.2100920677185
   214    -2.749791e+02     2.084206e-05
 * time: 565.6448891162872
   215    -2.749791e+02     9.324915e-06
 * time: 567.5337669849396
   216    -2.749791e+02     5.471692e-06
 * time: 568.922886133194
   217    -2.749791e+02     1.349247e-06
 * time: 571.3340220451355
   218    -2.749791e+02     6.012328e-07
 * time: 572.4434142112732
   219    -2.749791e+02     1.262219e-06
 * time: 574.6896131038666
   220    -2.749791e+02     1.030794e-05
 * time: 579.6846401691437
   221    -2.749791e+02     1.208479e-06
 * time: 581.5224471092224
   222    -2.749791e+02     1.504367e-06
 * time: 583.9223330020905
   223    -2.749791e+02     1.894769e-05
 * time: 586.80770611763
   224    -2.749791e+02     5.849402e-06
 * time: 587.9805200099945
   225    -2.749791e+02     8.592052e-06
 * time: 589.1774690151215
   226    -2.749791e+02     3.051369e-06
 * time: 591.5413451194763
   227    -2.749791e+02     1.107371e-05
 * time: 594.4734630584717
   228    -2.749791e+02     1.210406e-05
 * time: 597.4375801086426
   229    -2.749791e+02     1.479878e-05
 * time: 598.6304171085358
   230    -2.749791e+02     2.634707e-06
 * time: 600.9927251338959
   231    -2.749791e+02     5.704988e-06
 * time: 602.8376920223236
   232    -2.749791e+02     2.292420e-06
 * time: 604.5490901470184
   233    -2.749791e+02     4.626647e-07
 * time: 605.7442910671234
   234    -2.749791e+02     8.027199e-06
 * time: 608.1280500888824
   235    -2.749791e+02     2.001982e-06
 * time: 611.0687351226807
   236    -2.749791e+02     9.825387e-06
 * time: 613.4378411769867
   237    -2.749791e+02     1.187071e-05
 * time: 615.2405002117157
   238    -2.749791e+02     1.838998e-06
 * time: 617.0855259895325
   239    -2.749791e+02     1.663563e-05
 * time: 619.4448959827423
   240    -2.749791e+02     9.032751e-06
 * time: 620.5372140407562
   241    -2.749791e+02     6.979985e-06
 * time: 622.3416349887848
   242    -2.749791e+02     3.333573e-06
 * time: 623.5304760932922
   243    -2.749791e+02     7.090762e-06
 * time: 625.9095261096954
   244    -2.749791e+02     2.483405e-05
 * time: 627.1064960956573
   245    -2.749791e+02     6.115149e-06
 * time: 628.2865262031555
   246    -2.749791e+02     9.632408e-07
 * time: 629.4882881641388
   247    -2.749791e+02     4.811393e-06
 * time: 630.663339138031
   248    -2.749791e+02     1.367385e-06
 * time: 631.8593280315399
   249    -2.749791e+02     1.143744e-05
 * time: 633.0335960388184
   250    -2.749791e+02     4.841402e-06
 * time: 634.233766078949
   251    -2.749791e+02     9.164353e-06
 * time: 635.413544178009
   252    -2.749791e+02     1.866700e-06
 * time: 638.4721632003784
   253    -2.749791e+02     2.052625e-06
 * time: 640.1598482131958
   254    -2.749791e+02     5.041256e-06
 * time: 642.5457360744476
   255    -2.749791e+02     8.385493e-06
 * time: 644.3114211559296
   256    -2.749791e+02     6.964349e-06
 * time: 645.6098840236664
   257    -2.749791e+02     3.816911e-06
 * time: 647.9679930210114
   258    -2.749791e+02     1.350204e-06
 * time: 652.6991891860962
   259    -2.749791e+02     9.854513e-06
 * time: 653.8046851158142
   260    -2.749791e+02     2.208512e-06
 * time: 655.0982210636139
   261    -2.749791e+02     6.920840e-06
 * time: 657.4750890731812
   262    -2.749791e+02     2.940122e-06
 * time: 658.5778160095215
   263    -2.749791e+02     1.039665e-06
 * time: 661.5612699985504
   264    -2.749791e+02     1.150769e-05
 * time: 663.3268401622772
   265    -2.749791e+02     1.332794e-06
 * time: 665.1442441940308
   266    -2.749791e+02     8.002372e-06
 * time: 666.3198070526123
   267    -2.749791e+02     1.846671e-06
 * time: 668.6987681388855
   268    -2.749791e+02     2.537653e-06
 * time: 670.4768431186676
   269    -2.749791e+02     1.925987e-05
 * time: 672.8453919887543
   270    -2.749791e+02     6.460027e-06
 * time: 674.1321911811829
   271    -2.749791e+02     3.874016e-06
 * time: 675.8371291160583
   272    -2.749791e+02     2.030813e-06
 * time: 678.1976630687714
   273    -2.749791e+02     8.310447e-06
 * time: 679.3908340930939
   274    -2.749791e+02     4.550655e-07
 * time: 680.5697209835052
   275    -2.749791e+02     1.946651e-06
 * time: 682.9410672187805
   276    -2.749791e+02     6.617490e-06
 * time: 687.6868731975555
   277    -2.749791e+02     2.796703e-07
 * time: 688.8819131851196
   278    -2.749791e+02     1.517909e-05
 * time: 695.1039981842041
   279    -2.749791e+02     3.059705e-06
 * time: 697.5224080085754
   280    -2.749791e+02     1.861846e-05
 * time: 699.9448699951172
   281    -2.749791e+02     4.665363e-06
 * time: 704.1538391113281
   282    -2.749791e+02     3.483308e-06
 * time: 705.466432094574
   283    -2.749791e+02     1.855615e-05
 * time: 707.1908280849457
   284    -2.749791e+02     1.295989e-05
 * time: 708.9895250797272
   285    -2.749791e+02     6.674504e-06
 * time: 710.3017899990082
   286    -2.749791e+02     2.186183e-05
 * time: 712.7187972068787
   287    -2.749791e+02     3.940217e-06
 * time: 713.8424751758575
   288    -2.749791e+02     1.518496e-05
 * time: 715.1634941101074
   289    -2.749791e+02     8.656908e-06
 * time: 716.2676889896393
   290    -2.749791e+02     3.677556e-06
 * time: 718.1837170124054
   291    -2.749791e+02     1.330103e-05
 * time: 719.4999160766602
   292    -2.749791e+02     1.957545e-05
 * time: 720.8251850605011
   293    -2.749791e+02     1.825606e-06
 * time: 722.7479732036591
   294    -2.749791e+02     2.248417e-05
 * time: 724.5237240791321
   295    -2.749791e+02     4.478288e-06
 * time: 726.343729019165
   296    -2.749791e+02     1.322297e-05
 * time: 728.7686610221863
   297    -2.749791e+02     1.438653e-05
 * time: 730.6213371753693
   298    -2.749791e+02     4.098058e-06
 * time: 732.983626127243
   299    -2.749791e+02     6.679695e-06
 * time: 736.5281851291656
   300    -2.749791e+02     1.496552e-06
 * time: 738.911787033081
   301    -2.749791e+02     2.407793e-06
 * time: 743.6381571292877
   302    -2.749791e+02     3.904577e-06
 * time: 744.8296902179718
   303    -2.749791e+02     5.517441e-06
 * time: 747.1969871520996
   304    -2.749791e+02     5.892550e-06
 * time: 748.3888680934906
   305    -2.749791e+02     1.918896e-06
 * time: 750.1431331634521
   306    -2.749791e+02     9.920190e-06
 * time: 751.9550352096558
   307    -2.749791e+02     3.404759e-06
 * time: 754.318558216095
   308    -2.749791e+02     4.043216e-06
 * time: 755.5037531852722
   309    -2.749791e+02     5.990911e-06
 * time: 756.7044880390167
   310    -2.749791e+02     3.651278e-06
 * time: 757.8928000926971
   311    -2.749791e+02     1.246341e-05
 * time: 759.791374206543
   312    -2.749791e+02     6.574672e-06
 * time: 763.7570400238037
   313    -2.749791e+02     2.094581e-05
 * time: 764.8899240493774
   314    -2.749791e+02     1.568989e-05
 * time: 766.2011752128601
   315    -2.749791e+02     9.399701e-06
 * time: 768.6362562179565
   316    -2.749791e+02     2.119460e-05
 * time: 770.3863840103149
   317    -2.749791e+02     1.278647e-05
 * time: 772.1777009963989
   318    -2.749791e+02     9.303258e-06
 * time: 773.489984035492
   319    -2.749791e+02     1.444158e-05
 * time: 775.2879700660706
   320    -2.749791e+02     8.026515e-06
 * time: 776.5167951583862
   321    -2.749791e+02     5.107639e-06
 * time: 778.3975172042847
   322    -2.749791e+02     1.823911e-05
 * time: 780.8159132003784
   323    -2.749791e+02     1.433684e-05
 * time: 782.549259185791
   324    -2.749791e+02     6.446988e-06
 * time: 784.3231952190399
   325    -2.749791e+02     1.394436e-05
 * time: 786.1542601585388
   326    -2.749791e+02     2.111933e-05
 * time: 787.3525931835175
   327    -2.749791e+02     1.137082e-05
 * time: 788.5668120384216
   328    -2.749791e+02     3.418518e-06
 * time: 790.9835031032562
   329    -2.749791e+02     1.000199e-05
 * time: 792.216334104538
   330    -2.749791e+02     1.346785e-05
 * time: 794.081029176712
   331    -2.749791e+02     6.381590e-06
 * time: 795.9006350040436
   332    -2.749791e+02     4.377934e-06
 * time: 797.7593340873718
   333    -2.749791e+02     5.208578e-06
 * time: 799.4731161594391
   334    -2.749791e+02     2.233620e-06
 * time: 801.2526161670685
   335    -2.749791e+02     9.657798e-06
 * time: 802.5529160499573
   336    -2.749791e+02     9.985486e-06
 * time: 804.2657060623169
   337    -2.749791e+02     1.806580e-05
 * time: 806.0517032146454
   338    -2.749791e+02     1.161841e-05
 * time: 807.9070470333099
   339    -2.749791e+02     1.009167e-05
 * time: 810.3207120895386
   340    -2.749791e+02     1.933698e-06
 * time: 812.1786890029907
   341    -2.749791e+02     4.042931e-06
 * time: 815.2375659942627
   342    -2.749791e+02     4.942122e-06
 * time: 816.5362300872803
   343    -2.749791e+02     9.619722e-07
 * time: 817.7614212036133
   344    -2.749791e+02     1.692575e-06
 * time: 820.2648341655731
   345    -2.749791e+02     9.870097e-06
 * time: 823.2713000774384
   346    -2.749791e+02     1.364584e-05
 * time: 824.6103811264038
   347    -2.749791e+02     2.858719e-06
 * time: 828.7904500961304
   348    -2.749791e+02     1.503806e-05
 * time: 831.9261691570282
   349    -2.749791e+02     3.983441e-06
 * time: 839.265477180481
   350    -2.749791e+02     1.235957e-05
 * time: 841.0802881717682
   351    -2.749791e+02     1.705636e-06
 * time: 842.3103320598602
   352    -2.749791e+02     9.561179e-07
 * time: 847.1893100738525
   353    -2.749791e+02     1.751453e-05
 * time: 852.024652004242
   354    -2.749791e+02     1.527697e-05
 * time: 853.2114520072937
   355    -2.749791e+02     6.361150e-06
 * time: 855.5827322006226
   356    -2.749791e+02     3.135961e-05
 * time: 857.3422811031342
   357    -2.749791e+02     7.257919e-06
 * time: 858.6332790851593
   358    -2.749791e+02     6.773807e-06
 * time: 859.7229950428009
   359    -2.749791e+02     1.064491e-06
 * time: 862.1366231441498
   360    -2.749791e+02     1.607097e-05
 * time: 864.5101220607758
   361    -2.749791e+02     5.426562e-06
 * time: 868.6858100891113
   362    -2.749791e+02     1.278474e-05
 * time: 869.8644251823425
   363    -2.749791e+02     6.460270e-06
 * time: 871.6290831565857
   364    -2.749791e+02     1.063313e-05
 * time: 874.6174890995026
   365    -2.749791e+02     8.533764e-06
 * time: 875.8192632198334
   366    -2.749791e+02     1.071413e-05
 * time: 878.1873509883881
   367    -2.749791e+02     9.237481e-06
 * time: 879.3762261867523
   368    -2.749791e+02     6.486787e-06
 * time: 880.5723540782928
   369    -2.749791e+02     2.939878e-06
 * time: 881.7563600540161
   370    -2.749791e+02     1.224893e-05
 * time: 882.9683351516724
   371    -2.749791e+02     9.994830e-06
 * time: 884.1551740169525
   372    -2.749791e+02     1.305337e-05
 * time: 886.5372350215912
   373    -2.749791e+02     6.007723e-06
 * time: 887.7383530139923
   374    -2.749791e+02     2.437408e-06
 * time: 890.6912291049957
   375    -2.749791e+02     7.471634e-06
 * time: 893.6837220191956
   376    -2.749791e+02     3.678578e-06
 * time: 894.8833301067352
   377    -2.749791e+02     2.393418e-06
 * time: 896.0605130195618
   378    -2.749791e+02     9.976842e-07
 * time: 897.2646250724792
   379    -2.749791e+02     1.297424e-06
 * time: 900.3048121929169
   380    -2.749791e+02     1.439709e-06
 * time: 902.7287020683289
   381    -2.749791e+02     4.735318e-06
 * time: 905.8205001354218
   382    -2.749791e+02     3.530199e-06
 * time: 907.0361480712891
   383    -2.749791e+02     9.821257e-07
 * time: 908.9396340847015
   384    -2.749791e+02     1.373562e-05
 * time: 910.688915014267
   385    -2.749791e+02     2.286388e-05
 * time: 911.9381091594696
   386    -2.749791e+02     7.308388e-06
 * time: 913.8880472183228
   387    -2.749791e+02     2.164969e-05
 * time: 915.0210251808167
   388    -2.749791e+02     2.178793e-05
 * time: 917.4735519886017
   389    -2.749791e+02     8.605587e-06
 * time: 918.8414540290833
   390    -2.749791e+02     1.319202e-05
 * time: 922.4226009845734
   391    -2.749791e+02     6.326662e-06
 * time: 925.4909222126007
   392    -2.749791e+02     3.329867e-05
 * time: 926.7244911193848
   393    -2.749791e+02     1.077600e-05
 * time: 928.6239061355591
   394    -2.749791e+02     1.978593e-05
 * time: 930.3641011714935
   395    -2.749791e+02     5.747663e-06
 * time: 932.1791710853577
   396    -2.749791e+02     3.931836e-06
 * time: 935.2218160629272
   397    -2.749791e+02     2.304048e-06
 * time: 937.2891001701355
   398    -2.749791e+02     4.205873e-06
 * time: 940.9411821365356
   399    -2.749791e+02     1.404098e-05
 * time: 942.6436460018158
   400    -2.749791e+02     5.657652e-07
 * time: 946.1989960670471
   401    -2.749791e+02     1.396556e-06
 * time: 951.5411510467529
   402    -2.749791e+02     8.965725e-06
 * time: 954.5116741657257
   403    -2.749791e+02     9.971099e-06
 * time: 956.2699310779572
   404    -2.749791e+02     6.036827e-06
 * time: 958.0761830806732
   405    -2.749791e+02     4.255711e-06
 * time: 961.0083060264587
   406    -2.749791e+02     9.849051e-06
 * time: 963.9956860542297
   407    -2.749791e+02     7.874674e-06
 * time: 965.7565062046051
   408    -2.749791e+02     2.222166e-06
 * time: 968.7368681430817
   409    -2.749791e+02     3.251416e-06
 * time: 973.6172661781311
   410    -2.749791e+02     4.197460e-06
 * time: 977.8696920871735
   411    -2.749791e+02     1.443239e-06
 * time: 980.905112028122
   412    -2.749791e+02     1.104777e-05
 * time: 983.9700720310211
   413    -2.749791e+02     1.870735e-05
 * time: 985.0647480487823
   414    -2.749791e+02     1.193769e-05
 * time: 986.8923120498657
   415    -2.749791e+02     7.589867e-07
 * time: 988.0644731521606
   416    -2.749791e+02     3.497917e-06
 * time: 993.4905741214752
   417    -2.749791e+02     1.273221e-05
 * time: 994.5945951938629
   418    -2.749791e+02     4.944474e-06
 * time: 995.8845381736755
   419    -2.749791e+02     1.170570e-06
 * time: 996.9811840057373
   420    -2.749791e+02     3.997524e-06
 * time: 999.3659200668335
   421    -2.749791e+02     4.021664e-06
 * time: 1000.6620190143585
   422    -2.749791e+02     1.611366e-05
 * time: 1002.3588140010834
   423    -2.749791e+02     4.452428e-06
 * time: 1004.1241040229797
   424    -2.749791e+02     1.146195e-05
 * time: 1007.1119911670685
   425    -2.749791e+02     1.640998e-05
 * time: 1010.175124168396
   426    -2.749791e+02     1.172393e-05
 * time: 1011.3279221057892
   427    -2.749791e+02     3.156960e-06
 * time: 1012.6177861690521
   428    -2.749791e+02     8.413853e-06
 * time: 1013.707269191742
   429    -2.749791e+02     1.287679e-05
 * time: 1015.5046820640564
   430    -2.749791e+02     1.426328e-05
 * time: 1016.6923780441284
   431    -2.749791e+02     1.061937e-05
 * time: 1017.8899071216583
   432    -2.749791e+02     2.288538e-06
 * time: 1019.0658421516418
   433    -2.749791e+02     3.223036e-06
 * time: 1021.4365592002869
   434    -2.749791e+02     4.188678e-06
 * time: 1022.6299650669098
   435    -2.749791e+02     1.116302e-05
 * time: 1035.053973197937
   436    -2.749791e+02     4.283624e-06
 * time: 1036.8740231990814
   437    -2.749791e+02     1.727684e-05
 * time: 1038.0457451343536
   438    -2.749791e+02     1.431766e-05
 * time: 1039.805608034134
   439    -2.749791e+02     1.850849e-06
 * time: 1041.60626912117
   440    -2.749791e+02     3.817760e-06
 * time: 1042.7849950790405
   441    -2.749791e+02     3.945462e-06
 * time: 1045.1563429832458
   442    -2.749791e+02     4.213393e-06
 * time: 1046.3502831459045
   443    -2.749791e+02     1.232321e-05
 * time: 1048.2047190666199
   444    -2.749791e+02     1.504843e-05
 * time: 1049.3306620121002
   445    -2.749791e+02     1.798799e-06
 * time: 1051.1744801998138
   446    -2.749791e+02     3.961299e-06
 * time: 1052.383483171463
   447    -2.749791e+02     9.813649e-07
 * time: 1053.6067440509796
   448    -2.749791e+02     9.975552e-06
 * time: 1056.033625125885
   449    -2.749791e+02     8.883526e-06
 * time: 1060.6293501853943
   450    -2.749791e+02     5.319447e-06
 * time: 1063.5989530086517
   451    -2.749791e+02     3.113044e-06
 * time: 1064.7797560691833
   452    -2.749791e+02     2.595042e-05
 * time: 1065.980164051056
   453    -2.749791e+02     5.713789e-06
 * time: 1067.18199300766
   454    -2.749791e+02     4.035388e-06
 * time: 1070.7615330219269
   455    -2.749791e+02     3.463952e-06
 * time: 1072.6191210746765
   456    -2.749791e+02     9.480816e-06
 * time: 1075.5193271636963
   457    -2.749791e+02     1.479935e-05
 * time: 1078.4850721359253
   458    -2.749791e+02     4.541990e-06
 * time: 1079.7859799861908
   459    -2.749791e+02     1.293933e-05
 * time: 1081.4857931137085
   460    -2.749791e+02     3.343858e-06
 * time: 1082.6838221549988
   461    -2.749791e+02     1.671811e-05
 * time: 1085.6180670261383
   462    -2.749791e+02     6.299788e-06
 * time: 1086.9083449840546
   463    -2.749791e+02     5.326845e-07
 * time: 1088.6072130203247
   464    -2.749791e+02     2.547243e-06
 * time: 1095.1319370269775
   465    -2.749791e+02     1.346550e-05
 * time: 1101.7737030982971
   466    -2.749791e+02     3.101109e-06
 * time: 1104.7767810821533
   467    -2.749791e+02     4.900376e-06
 * time: 1106.0764031410217
   468    -2.749791e+02     1.167772e-05
 * time: 1109.0227711200714
   469    -2.749791e+02     1.183631e-05
 * time: 1111.4438381195068
   470    -2.749791e+02     1.837091e-06
 * time: 1113.3349120616913
   471    -2.749791e+02     3.976160e-06
 * time: 1115.7626900672913
   472    -2.749791e+02     4.870540e-06
 * time: 1118.1890950202942
   473    -2.749791e+02     4.837840e-06
 * time: 1119.9246060848236
   474    -2.749791e+02     1.225847e-05
 * time: 1121.1468901634216
   475    -2.749791e+02     2.027199e-06
 * time: 1124.1787950992584
   476    -2.749791e+02     5.590960e-06
 * time: 1125.4938051700592
   477    -2.749791e+02     1.341083e-05
 * time: 1126.6148672103882
   478    -2.749791e+02     7.327081e-06
 * time: 1127.9371531009674
   479    -2.749791e+02     5.997413e-06
 * time: 1129.680438041687
   480    -2.749791e+02     9.547734e-06
 * time: 1130.945412158966
   481    -2.749791e+02     2.468283e-06
 * time: 1133.3715040683746
   482    -2.749791e+02     5.363933e-06
 * time: 1135.2518591880798
   483    -2.749791e+02     7.358035e-06
 * time: 1136.9780910015106
   484    -2.749791e+02     7.368150e-07
 * time: 1139.5014851093292
   485    -2.749791e+02     2.176596e-05
 * time: 1141.295261144638
   486    -2.749791e+02     5.156410e-06
 * time: 1143.1255559921265
   487    -2.749791e+02     2.081569e-06
 * time: 1144.329924106598
   488    -2.749791e+02     2.765394e-06
 * time: 1146.1232931613922
   489    -2.749791e+02     1.140070e-05
 * time: 1148.5479321479797
   490    -2.749791e+02     1.119715e-05
 * time: 1149.8807101249695
   491    -2.749791e+02     8.191616e-06
 * time: 1150.9862570762634
   492    -2.749791e+02     2.153959e-06
 * time: 1152.8177239894867
   493    -2.749791e+02     7.777737e-06
 * time: 1154.703987121582
   494    -2.749791e+02     8.561052e-06
 * time: 1180.1527380943298
   495    -2.749791e+02     2.605161e-06
 * time: 1182.0586941242218
   496    -2.749791e+02     8.335118e-06
 * time: 1185.085286140442
   497    -2.749791e+02     1.538839e-05
 * time: 1186.3408741950989
   498    -2.749791e+02     6.820767e-06
 * time: 1187.5717701911926
   499    -2.749791e+02     6.263808e-06
 * time: 1190.043531179428
   500    -2.749791e+02     1.671432e-06
 * time: 1192.0589580535889
   501    -2.749791e+02     1.955455e-05
 * time: 1200.3237981796265
   502    -2.749791e+02     7.344942e-06
 * time: 1202.3330810070038
   503    -2.749791e+02     3.449034e-06
 * time: 1205.3870720863342
   504    -2.749791e+02     3.986073e-06
 * time: 1207.2833960056305
   505    -2.749791e+02     2.202366e-05
 * time: 1209.7646951675415
   506    -2.749791e+02     1.512422e-06
 * time: 1210.9063529968262
   507    -2.749791e+02     1.506048e-05
 * time: 1213.3684251308441
   508    -2.749791e+02     9.667089e-06
 * time: 1214.6870810985565
   509    -2.749791e+02     3.814121e-06
 * time: 1216.4426259994507
   510    -2.749791e+02     1.571757e-06
 * time: 1217.7007131576538
   511    -2.749791e+02     1.167312e-06
 * time: 1218.920608997345
   512    -2.749791e+02     7.697348e-07
 * time: 1220.1638600826263
   513    -2.749791e+02     8.795643e-06
 * time: 1222.0502071380615
   514    -2.749791e+02     4.274403e-06
 * time: 1223.181252002716
   515    -2.749791e+02     2.569504e-06
 * time: 1226.3634161949158
   516    -2.749791e+02     2.976023e-06
 * time: 1228.1909880638123
   517    -2.749791e+02     2.284516e-06
 * time: 1229.517580986023
   518    -2.749791e+02     5.599121e-06
 * time: 1230.6371490955353
   519    -2.749791e+02     6.644175e-06
 * time: 1232.4912240505219
   520    -2.749791e+02     1.439984e-06
 * time: 1234.3904941082
   521    -2.749791e+02     1.016570e-05
 * time: 1236.1302480697632
   522    -2.749791e+02     6.254181e-06
 * time: 1238.5773060321808
   523    -2.749791e+02     1.231639e-05
 * time: 1239.822219133377
   524    -2.749791e+02     7.111689e-06
 * time: 1241.7240250110626
   525    -2.749791e+02     8.944613e-06
 * time: 1242.8424870967865
   526    -2.749791e+02     4.875783e-06
 * time: 1244.1803259849548
   527    -2.749791e+02     1.454471e-06
 * time: 1247.7360200881958
   528    -2.749791e+02     3.147527e-06
 * time: 1251.4841611385345
   529    -2.749791e+02     8.052797e-06
 * time: 1252.603451013565
   530    -2.749791e+02     4.561864e-06
 * time: 1253.9411551952362
   531    -2.749791e+02     4.949042e-06
 * time: 1256.3719260692596
   532    -2.749791e+02     1.602531e-05
 * time: 1257.4865272045135
   533    -2.749791e+02     4.415089e-06
 * time: 1261.849424123764
   534    -2.749791e+02     6.531383e-06
 * time: 1267.9231841564178
   535    -2.749791e+02     4.004086e-06
 * time: 1269.8070220947266
   536    -2.749791e+02     1.361861e-05
 * time: 1272.2190690040588
   537    -2.749791e+02     1.152693e-05
 * time: 1274.638917207718
   538    -2.749791e+02     1.919680e-05
 * time: 1275.9491920471191
   539    -2.749791e+02     1.200694e-05
 * time: 1277.679044008255
   540    -2.749791e+02     5.951989e-07
 * time: 1279.5561361312866
   541    -2.749791e+02     5.037421e-06
 * time: 1282.6627089977264
   542    -2.749791e+02     5.733185e-06
 * time: 1285.8229100704193
   543    -2.749791e+02     1.332362e-05
 * time: 1288.274602174759
   544    -2.749791e+02     4.856469e-06
 * time: 1290.0193350315094
   545    -2.749791e+02     4.862303e-06
 * time: 1296.7021090984344
   546    -2.749791e+02     6.287169e-06
 * time: 1298.8318560123444
   547    -2.749791e+02     3.075776e-06
 * time: 1301.1909971237183
   548    -2.749791e+02     7.541472e-06
 * time: 1304.7241101264954
   549    -2.749791e+02     7.930556e-06
 * time: 1307.0819780826569
   550    -2.749791e+02     3.717674e-06
 * time: 1308.2731051445007
   551    -2.749791e+02     1.316018e-05
 * time: 1310.1279351711273
   552    -2.749791e+02     8.646882e-06
 * time: 1311.833799123764
   553    -2.749791e+02     8.667499e-06
 * time: 1314.180878162384
   554    -2.749791e+02     2.121494e-05
 * time: 1315.3811540603638
   555    -2.749791e+02     5.985388e-06
 * time: 1316.5511741638184
   556    -2.749791e+02     1.509744e-05
 * time: 1317.7440481185913
   557    -2.749791e+02     6.371338e-06
 * time: 1318.9489951133728
   558    -2.749791e+02     6.841065e-06
 * time: 1320.149185180664
   559    -2.749791e+02     5.196928e-06
 * time: 1321.3220751285553
   560    -2.749791e+02     3.246984e-06
 * time: 1322.5152552127838
   561    -2.749791e+02     2.260708e-05
 * time: 1324.8845372200012
   562    -2.749791e+02     6.668715e-06
 * time: 1326.06063914299
   563    -2.749791e+02     2.362581e-05
 * time: 1327.2593641281128
   564    -2.749791e+02     1.811975e-05
 * time: 1328.4335780143738
   565    -2.749791e+02     1.334840e-05
 * time: 1330.212788105011
   566    -2.749791e+02     2.102787e-05
 * time: 1332.0396602153778
   567    -2.749791e+02     1.050706e-06
 * time: 1334.414221048355
   568    -2.749791e+02     1.177692e-06
 * time: 1335.594113111496
   569    -2.749791e+02     2.135562e-06
 * time: 1342.072701215744
   570    -2.749791e+02     6.261700e-06
 * time: 1343.890547990799
   571    -2.749791e+02     3.560651e-06
 * time: 1345.0640630722046
   572    -2.749791e+02     2.845667e-06
 * time: 1347.4297590255737
   573    -2.749791e+02     2.040425e-05
 * time: 1348.725028038025
   574    -2.749791e+02     9.776756e-06
 * time: 1351.15900015831
   575    -2.749791e+02     1.872698e-05
 * time: 1353.0551090240479
   576    -2.749791e+02     4.270641e-06
 * time: 1355.4841940402985
   577    -2.749791e+02     4.370427e-06
 * time: 1357.2182660102844
   578    -2.749791e+02     3.029617e-06
 * time: 1358.4529151916504
   579    -2.749791e+02     1.006861e-05
 * time: 1359.6804401874542
   580    -2.749791e+02     5.736737e-06
 * time: 1362.0388391017914
   581    -2.749791e+02     1.033989e-05
 * time: 1363.8011701107025
   582    -2.749791e+02     2.679290e-06
 * time: 1365.0840981006622
   583    -2.749791e+02     3.233189e-06
 * time: 1366.7901120185852
   584    -2.749791e+02     2.942323e-05
 * time: 1368.5564000606537
   585    -2.749791e+02     3.900195e-05
 * time: 1369.85089802742
   586    -2.749791e+02     1.629325e-06
 * time: 1371.5622911453247
   587    -2.749791e+02     4.846014e-06
 * time: 1372.7548570632935
   588    -2.749791e+02     6.647589e-06
 * time: 1376.9653961658478
   589    -2.749791e+02     4.773093e-06
 * time: 1378.6645591259003
   590    -2.749791e+02     1.180790e-05
 * time: 1381.045618057251
   591    -2.749791e+02     2.729329e-06
 * time: 1385.3037459850311
   592    -2.749791e+02     7.922722e-06
 * time: 1386.616219997406
   593    -2.749791e+02     1.837754e-05
 * time: 1387.7262341976166
   594    -2.749791e+02     6.907936e-06
 * time: 1389.5740420818329
   595    -2.749791e+02     3.504556e-06
 * time: 1390.7843902111053
   596    -2.749791e+02     6.991749e-06
 * time: 1391.9934570789337
   597    -2.749791e+02     1.214813e-05
 * time: 1393.2017331123352
   598    -2.749791e+02     1.150144e-05
 * time: 1394.4119701385498
   599    -2.749791e+02     1.492544e-06
 * time: 1396.2959401607513
   600    -2.749791e+02     2.001676e-05
 * time: 1403.0214881896973
   601    -2.749791e+02     2.913975e-05
 * time: 1404.235424041748
   602    -2.749791e+02     7.771001e-06
 * time: 1406.1204450130463
   603    -2.749791e+02     2.023927e-06
 * time: 1410.2567110061646
   604    -2.749791e+02     3.172943e-06
 * time: 1412.0423140525818
   605    -2.749791e+02     7.296779e-06
 * time: 1413.8752851486206
   606    -2.749791e+02     3.811345e-06
 * time: 1415.7550880908966
   607    -2.749791e+02     2.127794e-06
 * time: 1416.8592460155487
   608    -2.749791e+02     2.395680e-06
 * time: 1420.7868571281433
   609    -2.749791e+02     1.257870e-05
 * time: 1421.8878149986267
   610    -2.749791e+02     7.598834e-06
 * time: 1424.2398591041565
   611    -2.749791e+02     2.518718e-06
 * time: 1426.5930771827698
   612    -2.749791e+02     1.753937e-05
 * time: 1428.39603805542
   613    -2.749791e+02     6.473244e-06
 * time: 1429.5789370536804
   614    -2.749791e+02     1.048501e-05
 * time: 1430.7724661827087
   615    -2.749791e+02     9.350115e-06
 * time: 1431.940425157547
   616    -2.749791e+02     2.515901e-06
 * time: 1434.965546131134
   617    -2.749791e+02     2.218820e-06
 * time: 1436.0562920570374
   618    -2.749791e+02     1.860930e-06
 * time: 1437.8599860668182
   619    -2.749791e+02     1.666259e-05
 * time: 1439.719249010086
   620    -2.749791e+02     3.480463e-06
 * time: 1442.5988020896912
   621    -2.749791e+02     1.665443e-05
 * time: 1444.4450840950012
   622    -2.749791e+02     1.354798e-05
 * time: 1445.54119515419
   623    -2.749791e+02     2.086935e-06
 * time: 1447.3795092105865
   624    -2.749791e+02     3.372929e-06
 * time: 1449.2373859882355
   625    -2.749791e+02     3.585756e-06
 * time: 1452.138337135315
   626    -2.749791e+02     3.249722e-06
 * time: 1456.4021990299225
   627    -2.749791e+02     3.254781e-06
 * time: 1457.4913802146912
   628    -2.749791e+02     1.578437e-06
 * time: 1459.3043961524963
   629    -2.749791e+02     1.791041e-05
 * time: 1461.210772037506
   630    -2.749791e+02     1.042408e-05
 * time: 1464.1106669902802
   631    -2.749791e+02     2.768567e-06
 * time: 1465.9726431369781
   632    -2.749791e+02     1.563209e-05
 * time: 1469.4653820991516
   633    -2.749791e+02     1.010230e-05
 * time: 1470.7580120563507
   634    -2.749791e+02     1.262072e-05
 * time: 1472.4521930217743
   635    -2.749791e+02     2.484051e-06
 * time: 1473.652594089508
   636    -2.749791e+02     9.876799e-06
 * time: 1475.5078740119934
   637    -2.749791e+02     1.851370e-05
 * time: 1477.2110130786896
   638    -2.749791e+02     1.799588e-06
 * time: 1478.4158301353455
   639    -2.749791e+02     1.745110e-05
 * time: 1479.605984210968
   640    -2.749791e+02     2.313819e-06
 * time: 1481.365432024002
   641    -2.749791e+02     2.958342e-06
 * time: 1482.6636760234833
   642    -2.749791e+02     1.233773e-05
 * time: 1484.418848991394
   643    -2.749791e+02     2.124837e-05
 * time: 1485.6558911800385
   644    -2.749791e+02     9.422972e-06
 * time: 1486.8716549873352
   645    -2.749791e+02     1.922215e-05
 * time: 1488.673623085022
   646    -2.749791e+02     1.275083e-06
 * time: 1491.251019001007
   647    -2.749791e+02     2.005683e-06
 * time: 1493.1334490776062
   648    -2.749791e+02     7.589593e-06
 * time: 1495.1780121326447
   649    -2.749791e+02     6.004079e-06
 * time: 1496.4086501598358
   650    -2.749791e+02     2.089333e-05
 * time: 1501.2715961933136
   651    -2.749791e+02     1.587493e-05
 * time: 1502.5938291549683
   652    -2.749791e+02     1.034733e-05
 * time: 1506.74778008461
   653    -2.749791e+02     4.640212e-06
 * time: 1516.53169298172
   654    -2.749791e+02     1.358606e-05
 * time: 1526.7487452030182
   655    -2.749791e+02     1.295131e-05
 * time: 1527.9650950431824
   656    -2.749791e+02     6.635872e-06
 * time: 1529.8386042118073
   657    -2.749791e+02     1.630579e-06
 * time: 1532.2220950126648
   658    -2.749791e+02     9.152173e-06
 * time: 1536.3200170993805
   659    -2.749791e+02     3.195318e-06
 * time: 1542.014023065567
   660    -2.749791e+02     6.791231e-06
 * time: 1544.9543371200562
   661    -2.749791e+02     9.462697e-06
 * time: 1547.3386070728302
   662    -2.749791e+02     7.291568e-06
 * time: 1552.0859560966492
   663    -2.749791e+02     4.085562e-06
 * time: 1553.9528110027313
   664    -2.749791e+02     2.240921e-05
 * time: 1556.8772501945496
   665    -2.749791e+02     1.419782e-05
 * time: 1558.7416760921478
   666    -2.749791e+02     4.817497e-06
 * time: 1561.1518671512604
   667    -2.749791e+02     2.089639e-05
 * time: 1563.5480391979218
   668    -2.749791e+02     6.793446e-06
 * time: 1565.940654039383
   669    -2.749791e+02     9.444194e-07
 * time: 1567.6590549945831
   670    -2.749791e+02     1.075482e-05
 * time: 1570.0469751358032
   671    -2.749791e+02     1.488306e-05
 * time: 1571.249442100525
   672    -2.749791e+02     5.797619e-06
 * time: 1572.4323830604553
   673    -2.749791e+02     2.766088e-05
 * time: 1574.190919160843
   674    -2.749791e+02     1.042830e-05
 * time: 1575.473955154419
   675    -2.749791e+02     1.591425e-05
 * time: 1577.855050086975
   676    -2.749791e+02     1.795199e-05
 * time: 1579.5800230503082
   677    -2.749791e+02     4.229797e-06
 * time: 1589.068929195404
   678    -2.749791e+02     1.887919e-05
 * time: 1590.8532600402832
   679    -2.749791e+02     6.674644e-06
 * time: 1592.1549530029297
   680    -2.749791e+02     9.298016e-06
 * time: 1593.8593780994415
   681    -2.749791e+02     7.296896e-06
 * time: 1595.0626521110535
   682    -2.749791e+02     1.474293e-05
 * time: 1596.2513830661774
   683    -2.749791e+02     1.896621e-05
 * time: 1597.4599730968475
   684    -2.749791e+02     1.312626e-05
 * time: 1599.3106000423431
   685    -2.749791e+02     8.869770e-06
 * time: 1600.42902302742
   686    -2.749791e+02     3.220329e-06
 * time: 1601.7276010513306
   687    -2.749791e+02     1.185379e-06
 * time: 1603.4286551475525
   688    -2.749791e+02     5.767165e-06
 * time: 1604.7616991996765
   689    -2.749791e+02     1.416938e-05
 * time: 1605.9994761943817
   690    -2.749791e+02     2.215655e-05
 * time: 1607.2179501056671
   691    -2.749791e+02     1.171116e-05
 * time: 1608.435562133789
   692    -2.749791e+02     9.525751e-06
 * time: 1610.2417361736298
   693    -2.749791e+02     1.767377e-05
 * time: 1611.5616080760956
   694    -2.749791e+02     4.971853e-06
 * time: 1613.2973091602325
   695    -2.749791e+02     2.614098e-06
 * time: 1615.7163372039795
   696    -2.749791e+02     6.026686e-06
 * time: 1618.1310901641846
   697    -2.749791e+02     5.274260e-06
 * time: 1619.3488612174988
   698    -2.749791e+02     3.517842e-06
 * time: 1621.2435150146484
   699    -2.749791e+02     5.155827e-06
 * time: 1623.7155871391296
   700    -2.749791e+02     3.233089e-06
 * time: 1626.7884120941162
   701    -2.749791e+02     1.606077e-05
 * time: 1629.8423891067505
   702    -2.749791e+02     4.057160e-06
 * time: 1631.7255940437317
   703    -2.749791e+02     5.979694e-06
 * time: 1636.6150720119476
   704    -2.749791e+02     4.875823e-06
 * time: 1638.5200221538544
   705    -2.749791e+02     1.935781e-05
 * time: 1640.2630820274353
   706    -2.749791e+02     5.258139e-06
 * time: 1641.497768163681
   707    -2.749791e+02     6.880065e-06
 * time: 1643.4975872039795
   708    -2.749791e+02     2.499554e-06
 * time: 1645.2194111347198
   709    -2.749791e+02     2.969611e-06
 * time: 1649.4138660430908
   710    -2.749791e+02     3.792733e-06
 * time: 1651.834501028061
   711    -2.749791e+02     2.337600e-06
 * time: 1656.6581180095673
   712    -2.749791e+02     2.785430e-06
 * time: 1657.9586310386658
   713    -2.749791e+02     9.860249e-06
 * time: 1659.6893000602722
   714    -2.749791e+02     6.233593e-06
 * time: 1661.2291271686554
   715    -2.749791e+02     1.017516e-05
 * time: 1663.598645210266
   716    -2.749791e+02     1.876285e-06
 * time: 1666.525309085846
   717    -2.749791e+02     4.205475e-06
 * time: 1668.8742032051086
   718    -2.749791e+02     3.640198e-06
 * time: 1672.5210890769958
   719    -2.749791e+02     5.853217e-06
 * time: 1673.6242790222168
   720    -2.749791e+02     2.847154e-06
 * time: 1675.9711530208588
   721    -2.749791e+02     3.558664e-06
 * time: 1678.3182740211487
   722    -2.749791e+02     7.015186e-06
 * time: 1681.3013970851898
   723    -2.749791e+02     1.089861e-05
 * time: 1682.4928541183472
   724    -2.749791e+02     6.068340e-06
 * time: 1684.3407151699066
   725    -2.749791e+02     1.074714e-05
 * time: 1686.72021317482
   726    -2.749791e+02     3.954579e-06
 * time: 1687.8244609832764
   727    -2.749791e+02     1.931870e-06
 * time: 1690.1897220611572
   728    -2.749791e+02     2.428241e-05
 * time: 1691.4894452095032
   729    -2.749791e+02     8.973294e-06
 * time: 1692.579528093338
   730    -2.749791e+02     7.891356e-07
 * time: 1693.8694541454315
   731    -2.749791e+02     7.954840e-06
 * time: 1695.5770800113678
   732    -2.749791e+02     1.847881e-06
 * time: 1696.7702541351318
   733    -2.749791e+02     3.562112e-06
 * time: 1699.7071640491486
   734    -2.749791e+02     1.472023e-06
 * time: 1701.031093120575
   735    -2.749791e+02     7.230147e-06
 * time: 1702.14173412323
   736    -2.749791e+02     1.615409e-06
 * time: 1703.989814043045
   737    -2.749791e+02     1.706898e-05
 * time: 1706.4215931892395
   738    -2.749791e+02     5.839329e-06
 * time: 1708.8433492183685
   739    -2.749791e+02     2.502789e-06
 * time: 1712.4677500724792
   740    -2.749791e+02     9.438547e-07
 * time: 1714.886332988739
   741    -2.749791e+02     1.120847e-05
 * time: 1716.6826031208038
   742    -2.749791e+02     8.217301e-06
 * time: 1717.9963221549988
   743    -2.749791e+02     4.781248e-06
 * time: 1723.5258400440216
   744    -2.749791e+02     1.542805e-05
 * time: 1725.4411311149597
   745    -2.749791e+02     8.089690e-06
 * time: 1727.200534105301
   746    -2.749791e+02     1.625627e-05
 * time: 1728.445358991623
   747    -2.749791e+02     5.937018e-06
 * time: 1729.6806321144104
   748    -2.749791e+02     1.602048e-06
 * time: 1732.8127300739288
   749    -2.749791e+02     6.761962e-07
 * time: 1735.7986280918121
   750    -2.749791e+02     6.385773e-07
 * time: 1739.3962252140045
   751    -2.749791e+02     3.631645e-06
 * time: 1743.5958080291748
   752    -2.749791e+02     6.825531e-06
 * time: 1744.9186441898346
   753    -2.749791e+02     3.005831e-06
 * time: 1747.953360080719
   754    -2.749791e+02     1.026728e-05
 * time: 1749.3050100803375
   755    -2.749791e+02     4.835055e-06
 * time: 1752.4257020950317
   756    -2.749791e+02     5.035334e-06
 * time: 1753.5507190227509
   757    -2.749791e+02     7.573971e-06
 * time: 1755.3641891479492
   758    -2.749791e+02     5.319966e-06
 * time: 1757.7636711597443
   759    -2.749791e+02     3.253055e-06
 * time: 1758.951788187027
   760    -2.749791e+02     2.358302e-06
 * time: 1761.3576490879059
   761    -2.749791e+02     1.897471e-05
 * time: 1763.742394208908
   762    -2.749791e+02     4.899677e-06
 * time: 1764.9531610012054
   763    -2.749791e+02     8.603609e-06
 * time: 1767.3212900161743
   764    -2.749791e+02     9.076843e-06
 * time: 1769.699508190155
   765    -2.749791e+02     1.826351e-05
 * time: 1770.9036490917206
   766    -2.749791e+02     1.523412e-06
 * time: 1772.6807231903076
   767    -2.749791e+02     2.725200e-05
 * time: 1775.0769522190094
   768    -2.749791e+02     7.057192e-06
 * time: 1776.909373998642
   769    -2.749791e+02     3.456369e-05
 * time: 1779.53498005867
   770    -2.749791e+02     5.225435e-06
 * time: 1781.7267260551453
   771    -2.749791e+02     4.089412e-06
 * time: 1782.870376110077
   772    -2.749791e+02     1.362364e-05
 * time: 1785.9328742027283
   773    -2.749791e+02     3.280827e-06
 * time: 1787.847146987915
   774    -2.749791e+02     3.565228e-07
 * time: 1789.718397140503
   775    -2.749791e+02     8.799004e-06
 * time: 1791.6281521320343
   776    -2.749791e+02     8.581631e-06
 * time: 1794.640783071518
   777    -2.749791e+02     4.323785e-06
 * time: 1796.4947772026062
   778    -2.749791e+02     7.541510e-06
 * time: 1798.1941912174225</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>trained Machine; caches model-specific representations of data
  model: GPR(μ = 0.0, …)
  args: 
    1:  Source @649 ⏎ Table{AbstractVector{Continuous}}
    2:  Source @589 ⏎ AbstractVector{Continuous}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rpt <span class="op">=</span> <span class="fu">report</span>(mach)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(rpt)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> <span class="fu">predict_mean</span>(mach, Xtrain);</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> <span class="fu">predict_mean</span>(mach, Xtest);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(summary = "L-BFGS", minimizer = [4.55030962847401, 0.9046179727440605, -3.4564696915758737], minimum = -274.97906545006106, iterations = 779, converged = false)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">scatterresult</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    ytrain, y_pred_train,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    ytest, y_pred_test,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"log10(σ) Truth"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) Fit"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    plot_title<span class="op">=</span><span class="st">"</span><span class="sc">$</span>(nice_name)<span class="st"> GPR Fit"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>┌ Warning: Keyword argument `orientation` is deprecated.
│ Please use `permute` instead.
└ @ Plots ~/.julia/packages/Plots/QZRtR/src/args.jl:1548</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">
<p><img src="NO3_files/figure-html/cell-17-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">quantilequantile</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    ytrain, y_pred_train,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    ytest, y_pred_test,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"log10(σ) Truth"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) Fit"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"</span><span class="sc">$</span>(nice_name)<span class="st"> GPR Fit"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<p><img src="NO3_files/figure-html/cell-18-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">scatter</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    Xtrain.λ,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    y_pred_train,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    zcolor<span class="op">=</span>Xtrain.T,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    ms<span class="op">=</span><span class="fl">3</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    msw<span class="op">=</span><span class="fl">0</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [</span><span class="sc">$</span>(λ_units)<span class="st">]"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    rightmargin<span class="op">=</span><span class="fl">10</span>Plots.mm,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">"T [</span><span class="sc">$</span>(T_units)<span class="st">]"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Training Data"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter!</span>(</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    Xtest.λ,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    y_pred_test,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    zcolor<span class="op">=</span>Xtest.T,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    ms<span class="op">=</span><span class="fl">3</span>, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    msw<span class="op">=</span><span class="fl">0</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># markershape=:rect,</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    markershape<span class="op">=:</span>star5,</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [</span><span class="sc">$</span>(λ_units)<span class="st">]"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    rightmargin<span class="op">=</span><span class="fl">10</span>Plots.mm,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">"T [</span><span class="sc">$</span>(T_units)<span class="st">]"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Predicted </span><span class="sc">$</span>(nice_name)<span class="st"> Cross Section"</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">"Testing Data"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<p><img src="NO3_files/figure-html/cell-19-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>λ_min <span class="op">=</span> <span class="fu">maximum</span>([min_data_λ, <span class="fu">minimum</span>(hr4000_df.λ)])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>λ_max <span class="op">=</span> <span class="fu">minimum</span>([max_data_λ, <span class="fu">maximum</span>(hr4000_df.λ)])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(λ_min)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(λ_max)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">plot</span>()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>Ts <span class="op">=</span> <span class="fl">292.0</span><span class="op">:</span><span class="fl">0.5</span><span class="op">:</span><span class="fl">300.0</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># cs = cgrad(:thermal, Ts, categorical = true)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> <span class="fu">cgrad</span>(<span class="op">:</span>roma, <span class="fu">size</span>(Ts,<span class="fl">1</span>), categorical <span class="op">=</span> <span class="cn">true</span>, rev<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> T <span class="op">∈</span> Ts</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    logσ <span class="op">=</span> <span class="fu">predict_logσ</span>(T, hr4000_df, mach, (λ_min, λ_max))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        hr4000_df.λ, logσ,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        alpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>cs[i],</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">"</span><span class="sc">$</span>(T)<span class="st"> K"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">=:</span>outertopright,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    i<span class="op">+=</span><span class="fl">1</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"λ [nm]"</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"log10(σ) [cm²]"</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="fu">title!</span>(<span class="st">"Predicted Cross Section at Spectrometer λ's"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>220.0
794.221</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="36">
<p><img src="NO3_files/figure-html/cell-20-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Tplot <span class="op">=</span> <span class="fl">298.0</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>logσ, Δlogσ <span class="op">=</span> <span class="fu">predict_logσ_wΔ</span>(Tplot, hr4000_df, mach, (λ_min, λ_max))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    hr4000_df.λ, logσ,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    ribbon<span class="op">=</span> <span class="fl">2</span> <span class="op">.*</span> Δlogσ,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    fillalpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [nm]"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Predicted log10(σ) at T = </span><span class="sc">$</span>(Tplot)<span class="st"> K"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>Tplot <span class="op">=</span> <span class="fl">294.0</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>logσ, Δlogσ <span class="op">=</span> <span class="fu">predict_logσ_wΔ</span>(Tplot, hr4000_df, mach, (λ_min, λ_max))</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    hr4000_df.λ, logσ,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    ribbon<span class="op">=</span> <span class="fl">2</span> <span class="op">.*</span> Δlogσ,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    fillalpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=:</span>purple,</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    xlabel<span class="op">=</span><span class="st">"λ [nm]"</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    ylabel<span class="op">=</span><span class="st">"log10(σ) [cm²]"</span>,</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Predicted log10(σ) at T = </span><span class="sc">$</span>(Tplot)<span class="st"> K"</span>,</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    label<span class="op">=</span><span class="st">""</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1, p2, layout<span class="op">=</span>(<span class="fl">1</span>,<span class="fl">2</span>), margin<span class="op">=</span><span class="fl">5</span>Plots.mm, size<span class="op">=</span>(<span class="fl">900</span>,<span class="fl">350</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<p><img src="NO3_files/figure-html/cell-21-output-1.svg" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>